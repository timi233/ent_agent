# 前端重构方案

## 设计目标
- 与后端领域模型对齐，围绕仪表盘、洞察分析、运营管理、权限配置、规划图层等模块构建导航体系。
- 提供响应式、数据驱动的界面框架，确保多终端展示一致且信息密度可控。
- 通过一致的设计语言（城市治理主题色、柔和卡片、统一图标）提升可信度与可用性。
- 强化交互体验：全局 Toast 与状态码联动、实时校验、乐观更新、实时通知通道。

## 信息架构与路由
- 采用固定侧边栏 + 顶栏的 AppShell，左侧聚焦领域导航，顶部承载筛选器与用户态。
- 路由结构：`/dashboard`、`/insights`、`/operations`、`/planning`、`/admin`，支持 RBAC 守卫与懒加载；空间规划视图结合 zoning store 提供图层勾选与地图占位。
- 视图目录与后端领域一一对应 (`src/views/<domain>`)，组合式函数与 Store 同名管理领域状态。

## 视觉与组件体系
- 在 `src/assets/styles/tokens.ts` 定义设计令牌并通过 CSS 变量落地主题与阴影。
- 组件分层：`components/base`（基础 UI）、`components/layout`（框架）、`components/data`（表格、图表、动态表单、地图占位）、`components/feedback`（消息）。
- 图表通过 `EChartsPanel` 封装主题与 Resize，仪表盘、洞察模块直接复用；`CityMapCanvas` 先行占位，便于后续对接真实地图 SDK。

## 状态管理与数据交互
- Pinia 按领域拆分 Store：仪表盘、洞察、运营、权限、规划图层、身份、全局筛选、Toast。
- `utils/apiClient.ts` 封装 axios，处理鉴权头、错误映射、重试入口。
- 组合式函数 `useDashboard/useInsights/useOperations/useZoning/useAdmin/useNotifications` 封装加载、缓存、实时连接与重载逻辑。
- 动态表单组件支持规则校验与乐观更新；运营模块示范快速工单创建流程。

## 质量与工具链
- 引入 Vitest + Vue Testing Library、Storybook、ESLint/Prettier/Stylelint 形成基础质量闭环。
- 配置别名、TS 严格模式、设计 tokens 与 CSS 全局样式；提供示例单测与 Storybook 预设。

## 迭代建议
1. 接入真实 API 与 WebSocket 并补齐鉴权策略。
2. 完成图表组件与地图联动，实现规划图层可视化。
3. 扩充 Storybook 与测试覆盖，补充端到端场景（Cypress/Lighthouse）。
4. 与设计及业务方共创组件标准，逐步沉淀设计系统文档。
